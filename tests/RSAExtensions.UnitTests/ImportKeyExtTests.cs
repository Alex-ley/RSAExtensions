using System;
using System.Security.Cryptography;
using Xunit;

namespace RSAExtensions.UnitTests
{
    public class ImportKeyExtTests
    {
        [Fact]
        public void ExportPkcs1PrivateKey_WithoutPEM_ShouldBeOk()
        {
            var rsa = RSA.Create();
            rsa.ImportPrivateKey(RSAKeyType.Pkcs1, "MIIEpAIBAAKCAQEAwutJA3T4/th/PCOv7ITtx1ESBSEkTplsGiIO/CY9tevb0lxQMW9TIWGdi/0Z72Pn8c9QFG+CSo+ye2ncrgl/ubm3Rato94nQarDDsfomKLcQeMFBE6I+qLZCjYriWxgA2xVF6px3XZd4yZh37ZTFDvAWFxI3dBXt8NrNyL8FCQ1d8viY6VmpD8+qUwYKlry48xCTxOrrvev73SFrnJU3owvMFkxzXn7tTEj0Jr2wHSU9m42lGNcFuvSQgL1OdZbn20SDDGQfXMyFW+B4twLkI2ZO2s5lLXaQKbZA3Z4puGQooY/NJh8mKDtVh3+UlKl3jH3ZIbFmAhwT0LLebVmU9QIDAQABAoIBAQCXj7n7PSYriw4MJjex8n6tYAViBa4ki7l57Ie4WsfbQCVyQaN9fPGn4C5P3qMe+JEu/iNncHlgHrIKsnsMvIgbUyQFwU3iRL/RZdcU+cxYFlhxfNtsN9j++JFxW8+8Q0LPF5CA598M4C3km3CNRQOhJOAYWmrSEgctJAWlFZsFuIkUpxzhXOK94UPLedkYSUZPxyeXOhW8IwUJiNJ+T4VtVT7Nwy/+Z8LfL8cB26hicHixlHqRlwCQWb72UWwVupN5P/P6J9ApYEev560+zBk058FCaIGsZ8dlRA5QPxUt4H6xZfvUhE/Lr/wMsT9poAD+RXPuz8ga1e9Zx+ldlewVAoGBAMrQa2qKR6mUc7Mmk1oWNDZSBYzxwfEQWWfmh0L+2/t+jvxLQs+iv3w3UR5Q+oQys9ejqbK/pgMkBapSpTboJ6nUXPf8/+QG87QWuMxvH2b4dW7wpxn6FjrTdUOYGATqYV9lXkdFccoRFOds5IK3SkngArUdf87E3V/Oib9ZJzybAoGBAPYI2DJSlSt9fT5pBRiCz+dAoH0DpmJ7AsPi1wFCnBBeAUJq6QRqXvntIeHaeKJtmyd5UZtrO8ewydFqwLGPyEPrq0xqKjO5O4gj1hkmoV9ppChhQ+xQgtyjeZ9+X+bRct2kR65dn+ZZ6l0ZuuoF2GA0igowQKWmI3Lts/loumWvAoGAMUtxIEcV3fDYIk4Y+Id3D1DmSnikU+xOXsOYUr9RRpJfPJEqXv9GnXFwhPbXvPP55ErCP1D3j8HcoqZNw8evhEa6hgf3RjwuVbJEHmRP9J4lJN7XLqgraQbmdJRuGhvBqQchYB9P5fY653j/HYphQw1wewb9fos450VzE5AeyksCgYEAmvxPVMP4/AB9GQeHEj21QfPQJXBbK8ZZo5QN5NlU/mp5WKGIUCPB2KaspV2+iHOLPX6LDeCrM8wGFkmtQS1V9pNKwURPeW3CNqx8fjN7jGM76cP7ya2eAedpAjPVrc1bEoweK5UG2VDi9erzd+BewZvXKTvkPXU+93MN4Js8cDkCgYAlp7Zupzd71zVAE8xdroBq1+D+TPZxWVyS9UCWNjuq++OFlBbevVyoBuV8QE3aF/8O6VgWIwrkopUVC8jCtXCduN+qalWLhAO2M+Y8f/xn3/d2KD3yt/gBOiHNRDZTi9H8+3CO+kf++s6MjeRVtPdY0l1ClRZ11MmJR97IFtLP7w==");
        }

        [Fact]
        public void ExportPkcs1PrivateKey_WithoutPEM_ShouldBeExp()
        {
            var rsa = RSA.Create();
            Assert.Throws<FormatException>(() => rsa.ImportPrivateKey(RSAKeyType.Pkcs1,
                "MIIEpAIBAAKCAQEAwutJA3T4/th/PCOv7ITtx1ESBSEkTplsGiIO/CY9tevb0lxQMW9TIWGdi/0Z72Pn8c9QFG+CSo+ye2ncrgl/ubm3Rato94nQarDDsfomKLcQeMFBE6I+qLZCjYriWxgA2xVF6px3XZd4yZh37ZTFDvAWFxI3dBXt8NrNyL8FCQ1d8viY6VmpD8+qUwYKlry48xCTxOrrvev73SFrnJU3owvMFkxzXn7tTEj0Jr2wHSU9m42lGNcFuvSQgL1OdZbn20SDDGQfXMyFW+B4twLkI2ZO2s5lLXaQKbZA3Z4puGQooY/NJh8mKDtVh3+UlKl3jH3ZIbFmAhwT0LLebVmU9QIDAQABAoIBAQCXj7n7PSYriw4MJjex8n6tYAViBa4ki7l57Ie4WsfbQCVyQaN9fPGn4C5P3qMe+JEu/iNncHlgHrIKsnsMvIgbUyQFwU3iRL/RZdcU+cxYFlhxfNtsN9j++JFxW8+8Q0LPF5CA598M4C3km3CNRQOhJOAYWmrSEgctJAWlFZsFuIkUpxzhXOK94UPLedkYSUZPxyeXOhW8IwUJiNJ+T4VtVT7Nwy/+Z8LfL8cB26hicHixlHqRlwCQWb72UWwVupN5P/P6J9ApYEev560+zBk058FCaIGsZ8dlRA5QPxUt4H6xZfvUhE/Lr/wMsT9poAD+RXPuz8ga1e9Zx+ldlewVAoGBAMrQa2qKR6mUc7Mmk1oWNDZSBYzxwfEQWWfmh0L+2/t+jvxLQs+iv3w3UR5Q+oQys9ejqbK/pgMkBapSpTboJ6nUXPf8/+QG87QWuMxvH2b4dW7wpxn6FjrTdUOYGATqYV9lXkdFccoRFOds5IK3SkngArUdf87E3V/Oib9ZJzybAoGBAPYI2DJSlSt9fT5pBRiCz+dAoH0DpmJ7AsPi1wFCnBBeAUJq6QRqXvntIeHaeKJtmyd5UZtrO8ewydFqwLGPyEPrq0xqKjO5O4gj1hkmoV9ppChhQ+xQgtyjeZ9+X+bRct2kR65dn+ZZ6l0ZuuoF2GA0igowQKWmI3Lts/loumWvAoGAMUtxIEcV3fDYIk4Y+Id3D1DmSnikU+xOXsOYUr9RRpJfPJEqXv9GnXFwhPbXvPP55ErCP1D3j8HcoqZNw8evhEa6hgf3RjwuVbJEHmRP9J4lJN7XLqgraQbmdJRuGhvBqQchYB9P5fY653j/HYphQw1wewb9fos450VzE5AeyksCgYEAmvxPVMP4/AB9GQeHEj21QfPQJXBbK8ZZo5QN5NlU/mp5WKGIUCPB2KaspV2+iHOLPX6LDeCrM8wGFkmtQS1V9pNKwURPeW3CNqx8fjN7jGM76cP7ya2eAedpAjPVrc1bEoweK5UG2VDi9erzd+BewZvXKTvkPXU+93MN4Js8cDkCgYAlp7Zupzd71zVAE8xdroBq1+D+TPZxWVyS9UCWNjuq++OFlBbevVyoBuV8QE3aF/8O6VgWIwrkopUVC8jCtXCduN+qalWLhAO2M+Y8f/xn3/d2KD3yt/gBOiHNRDZTi9H8+3CO+kf++s6MjeRVtPdY0l1ClRZ11MmJR97IFtLP7w"));
        }

        [Fact]
        public void ExportPkcs1PrivateKey_WithPEM_ShouldBeOk()
        {
            var rsa = RSA.Create();
            rsa.ImportPrivateKey(RSAKeyType.Pkcs1, @"-----BEGIN RSA PRIVATE KEY-----
MIIEpAIBAAKCAQEAy0KT5Zrfy89V60VdIEktKKVh8Tpil4Fw7h+/4ZvWQrOJhQ5h
xpL/2BJkg4QEbHlP6ItF9HduIYMlp+vmpPi1ysG2mkRe+7is9AnLAnf6/MvzJFFF
F/Onc+eegnfRxvxJ8aTx+yE8QwwOeOkfLds9kTnj2UQCND59HtB2ksec0r88WdOS
6XtCCYTQPYovnKvPNW859rd/e8qNPQ6vCFXjmNTGYH/tvAXqAq5C3jMs3ayVEbq0
l5Qn1itSTM5gdiWV5cR2hLDb7J61AMPOQq5tdLxL5s/lJ/gXyLl1e0mEZfO0oQlz
XFqsarkXJYjWyQhnUpG5S5cUqVeLicSIaW+dWQIDAQABAoIBAQCseM/6UlJ4JHSp
cHA3ByDUjpDvGjWyjVmAFVzCWXOTobidOLjqwK1rcR/tIMaILOALWLKBYB4JPblk
JZ3OemP3qiwB9uYJ/ohzgyPJ8nj8rSqhtHxGeK+sf+tWlclhaY5tByN1jpwN4Fsf
aeDVDmXNpyuZnkWogyW0UftrTQnbIHs4clsE4tzxd9BtP7iWDxT/9qBHf7w10+r8
kJBCP0O7pX9vkS24E8BCQR8uw2Iv/920QTdmUr7CB406y2ViWupNGLJzJIJ6prrT
r1oQ1hUHJl+VcDGE042nTGeXxOjr1CoSJVG9w+Vp/zea7z/+N7FjMjbb4458LGEa
MiomAdnJAoGBAOYCA6srqfLgLtiJNz0/X3oEYC4+gJVlgpBT2uBJSc/joaFa4blB
c08Mm55hUNGbwExNabWcVeqI6Mhnb9qKz4cp0iasMX/pLVdrYnOSHbTSE4E8U3KC
CYhiq6mzje9JN3yO4BOB1W8oDPqiCU7oIYmPqnc9YO3WY3Ai4G0GN5cPAoGBAOI6
xB0SYAJKd95AXIgub6oOhm55GcHaxEdDp16qf9h5olnIQCsQQMD1WSuqSlhLs1co
JLZJBeNFvIQfIYRRg4l46ka7RSeXwKF+BXhC+7KeGG6dj4B7R7yZ2iGuNWynRIKn
vbCtOUty6fmSjo1jAc7ErqArM8+1eATLz+VlpkUXAoGBANAddHpV6NF1HY4aIhxO
EjLScMCHF0uWbNvws/QK/DmZiy73j5RTb2VQUCKvhTQTzJx90y9bhLXRKWfjh+bj
gMGZCqipV6SYNMmLxaoyxKRPDQz7q7nJhZydQxwq9jtUMVuH36Jm8NtCDvRc1zVJ
fsb8ck6v/9tUB+d39z9Ox8/rAoGAAInbRaZxjA/ZUTIeBkT2BxWZxFGNeiSnKvRC
RbtqKn2/oS8U2AVl4g+zcqMpIiSr/J0f2T87QFs+I6JfVg1Lntwm0pxHgdyenMPM
B4lBSB+QN1MwsEGa3hwPpNzhS6zqQNVdYjpHVKKlY+6xYCzIKFHXiJIRwYDRFFHX
4NfpGWkCgYBOtrmreUNmPrDJeBEkCmLbnLJwB8uGDEbjQeljrAyJT9lrNgTCyxZ8
03bsgeO/CEcXTUXkLX0p5j0GO1l1V1LXiqTPpVfe0idq2u7r9erOWjNy6WAiM3nb
eHySyXvTRNnOoqtl/H7ZGZMpJu/Qn+nJcFl2DECoJSrGBZyzCBhDpw==
-----END RSA PRIVATE KEY-----", true);
        }

        [Fact]
        public void ExportPkcs8PrivateKey_WithoutPEM_ShouldBeOk()
        {
            var rsa = RSA.Create();
            rsa.ImportPrivateKey(RSAKeyType.Pkcs8, "MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQDvOzxVDfg1BzMyvIdA3iDISBdCr8m+wY7ccFqcna/BvWAKvnWjY3zFu0Gpy2xrQvuSLtFXzUkFJrrru7stF5IeJ11QUjiiBlpv35crOMxA7NA4d+bteQrgQhsypEoCyRs/biXLoK4RQrGUAy+X1qRPyjJHO4cFMYcWcZPgQCLy2MN31VTYkeP1k0r7UGPJBKjm/ZGCTK8WeE6nWyuqh6WXjNToea1fFWjaOMzzbjrV/d1pq9i3N7H0KXgMVp7hPm8m2CsCXmER0DqueU8DIhbKqVXg33kYakxevxo8oGM2FelU45ZW7M/dv4+KtIBVKH4h7c7/4Bs0lo8tNJ1+T4lJAgMBAAECggEBAJ0g1gazbzQ9L2aCp392pieGGikF1seA0Dl/XjSB6Z+hp8RGxnNzc89Xp9BDOUnWK/Ae6gb2YaCNiLYujskWMzW0+zg3WNUqwRm7zMlpu9Zk9HoyXq3ZE8iqAr0nZSkhN9FYomB1f/78RDCISyk6pJ93mcBpm8xQdH7MSKlA1vOTINJPcMxfMfZVjDXKoeM3cVYOkFT6+T+LEe1sM0buYyh/ovcVmnh67rEuu6oHGQJY51tC25kZ1J+Z+eaMM9kTtIOsYFUNs0AFyo8WhgANzCAUovsq1Or7VU7rOeLGjEHJYZPOwTH7hDDXEH4rUaYOboTHYT0jdFtq/JNMy/xFu2UCgYEA/ksdQIH9ZsmE+Dlfn4lA7E4BTb5xOpSE5hx4Jja4xeIYPycPbC46SgwWwGIwuZespHH184e+7ZP6410DzGkpNTVOzqRLNfuJF+CdHSU/J2BLHr+L8ZttgGDXU+EhObn+MOcGNzuakr0Ez0iWVWf5nBvhYxoBTsQi2HD17Uliu38CgYEA8NY+iNiihcNDGh0jBFZzkfuDq3JJ6AYyv/hnqLKz0bi1tGvZL4htUKF16AvvCVN6aLqnlkP2pgY1StKaIiknSmW3jyMAIRpsQVylw9CsP8IAnGnLeSH1CLAnUpBsv8asau9n9GP8lEz8zifYDO6lS6PM4XvyBe0g39jZWGCLPzcCgYB3ZGj9ioqhIeiOatGco+KZkB5IlCuxZ13mdGNs/bBPKFJeBEbXcfToIzjjZradzLrAEsl5Z7ia7ymSam+IH6+7TaYMm1K8q7a4QTtDHePC5xEeBKz96Q3GgrFWrpLc+ZiA+VcPw6pVTu3dLKV4v/KP+v8dem42vxvlJ1Qv7o6unQKBgDpYXPwAJ5dqT6ZS6rnRS9xQ53wwivEYF1Fkl5BKAsBLFFIqUopubbU7+HmH8pf6zkvy9Ei2HFnqZRzEWqzt9WPTsp2NqClc4l8PV+VRd3lWwZkjFDU7YcaCDnS1InNvaTPa3f9Z/cXbxN8YzgGMCyWBAFCcG20OHom8WiNL+FAPAoGBAI8lN6F4LJIOIMFN38bqLPsHoHjbfIYdkOL+2NP1guf9kNwRken+vDfeqiw8QBPWzIXkmVfKuTDpG4m4ebKrClJymGN15XGsjl2r0Q1Pu59/ER5fpNKVq5yu9wFL/WrbIHrU78zrS3SGD7rh3oaf/kOXZfr0mFTaetiC/CNIs592");
        }

        [Fact]
        public void ExportPkcs8PrivateKey_WithoutPEM_ShouldBeExp()
        {
            var rsa = RSA.Create();
            Assert.Throws<FormatException>(() => rsa.ImportPrivateKey(RSAKeyType.Pkcs8,
                "MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQDvOzxVDfg1BzMyvIdA3iDISBdCr8m+wY7ccFqcna/BvWAKvnWjY3zFu0Gpy2xrQvuSLtFXzUkFJrrru7stF5IeJ11QUjiiBlpv35crOMxA7NA4d+bteQrgQhsypEoCyRs/biXLoK4RQrGUAy+X1qRPyjJHO4cFMYcWcZPgQCLy2MN31VTYkeP1k0r7UGPJBKjm/ZGCTK8WeE6nWyuqh6WXjNToea1fFWjaOMzzbjrV/d1pq9i3N7H0KXgMVp7hPm8m2CsCXmER0DqueU8DIhbKqVXg33kYakxevxo8oGM2FelU45ZW7M/dv4+KtIBVKH4h7c7/4Bs0lo8tNJ1+T4lJAgMBAAECggEBAJ0g1gazbzQ9L2aCp392pieGGikF1seA0Dl/XjSB6Z+hp8RGxnNzc89Xp9BDOUnWK/Ae6gb2YaCNiLYujskWMzW0+zg3WNUqwRm7zMlpu9Zk9HoyXq3ZE8iqAr0nZSkhN9FYomB1f/78RDCISyk6pJ93mcBpm8xQdH7MSKlA1vOTINJPcMxfMfZVjDXKoeM3cVYOkFT6+T+LEe1sM0buYyh/ovcVmnh67rEuu6oHGQJY51tC25kZ1J+Z+eaMM9kTtIOsYFUNs0AFyo8WhgANzCAUovsq1Or7VU7rOeLGjEHJYZPOwTH7hDDXEH4rUaYOboTHYT0jdFtq/JNMy/xFu2UCgYEA/ksdQIH9ZsmE+Dlfn4lA7E4BTb5xOpSE5hx4Jja4xeIYPycPbC46SgwWwGIwuZespHH184e+7ZP6410DzGkpNTVOzqRLNfuJF+CdHSU/J2BLHr+L8ZttgGDXU+EhObn+MOcGNzuakr0Ez0iWVWf5nBvhYxoBTsQi2HD17Uliu38CgYEA8NY+iNiihcNDGh0jBFZzkfuDq3JJ6AYyv/hnqLKz0bi1tGvZL4htUKF16AvvCVN6aLqnlkP2pgY1StKaIiknSmW3jyMAIRpsQVylw9CsP8IAnGnLeSH1CLAnUpBsv8asau9n9GP8lEz8zifYDO6lS6PM4XvyBe0g39jZWGCLPzcCgYB3ZGj9ioqhIeiOatGco+KZkB5IlCuxZ13mdGNs/bBPKFJeBEbXcfToIzjjZradzLrAEsl5Z7ia7ymSam+IH6+7TaYMm1K8q7a4QTtDHePC5xEeBKz96Q3GgrFWrpLc+ZiA+VcPw6pVTu3dLKV4v/KP+v8dem42vxvlJ1Qv7o6unQKBgDpYXPwAJ5dqT6ZS6rnRS9xQ53wwivEYF1Fkl5BKAsBLFFIqUopubbU7+HmH8pf6zkvy9Ei2HFnqZRzEWqzt9WPTsp2NqClc4l8PV+VRd3lWwZkjFDU7YcaCDnS1InNvaTPa3f9Z/cXbxN8YzgGMCyWBAFCcG20OHom8WiNL+FAPAoGBAI8lN6F4LJIOIMFN38bqLPsHoHjbfIYdkOL+2NP1guf9kNwRken+vDfeqiw8QBPWzIXkmVfKuTDpG4m4ebKrClJymGN15XGsjl2r0Q1Pu59/ER5fpNKVq5yu9wFL/WrbIHrU78zrS3SGD7rh3oaf/kOXZfr0mFTaetiC/CNIs59"));
        }

        [Fact]
        public void ExportPkcs8PrivateKey_WithPEM_ShouldBeOk()
        {
            var rsa = RSA.Create();
            rsa.ImportPrivateKey(RSAKeyType.Pkcs8, @"-----BEGIN PRIVATE KEY-----
MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQC+Z0sLTtNVu/Qt
5vViotHLRPO0u/7Q0PkmlpRawJVouisqxRneSZphAONTNOS5WmFwYBPxVaeeFmnI
1hbGLWo8lNcVjyuedFus5Iioaoq1QDZtdxlPQY+UfHTGJrxI0bdA4wZdQV95ZiuP
cf3WopvZmRQxSP7liaHPxj2Pcaqh7kM+b2vymBfWKoWyHYj4ZrsWtNhl9+6Qu6ep
j4hao4R+8lSkL83bFQdQGZqumlYUkKTjVdX52h4gt16oSOiTeDLd8b+wddmRQRH1
8Yx6W8age+YKrGsced09Z6zg0+JiVrLbj+6EvxKeiSUwNJWKCao3Mtb6FU/QaFTE
IkJHF7BZAgMBAAECggEAU/ulqzAyoU9NDe4gcEhW9yzLvf1qENsL+oxSlZD6lf3/
ylaz6UtXz8+fdXUQKf2GmxWV1k4sp9tE/7QGyZUAlgYktLq4x6SVRzZqXLbZxcaz
+yacQEwvs5QNwdUWGZx/ExzQEtQh858wOY5TI5gH3DvcHz0OSVqix82uG5ZMaC24
EY3Cf11N7mA5uUlrBiTyT8+1Mob7fjzaDF49GtRMvxMEwNx0/JfzpS2a5q6oulOf
iayXdN2RofsEhBDYVfpW1GPZjq0uAU62qRwfFlXvbb/JoiOhhnr0d9Zx/X5AhZuf
V6Z6F9RqERNyQEZvP/oCwY7Cj55YLYAFh5YkYllSjQKBgQDVAyH/X9kC9gp5vwFI
B7R1bmemp50uOVodnXsNS2RPHQVen4Y4o6CK2mYHmi002PQgyPpXTh4eIMgjzlnC
8T9rc3vxQfa3eINorQBmwY+4GaX6EhxT4MkPwCzbOVO1gljkU7kefVF98ed6WVPH
6o8YRkquZiUD9eAaJhoA4xspCwKBgQDk1B9zxaS9wMzYA3vcMsny75DD8emW4Cri
7IYJbYPqwjgGn88AMk0nlTV27tPh14JSO3W+J8VmkJ4qqW0+bFO/RU/pfakPbIVf
doaSmie6Jk/0MKC1ImlRT/ezcnOAkvp+vFtRcpuJD08pfcWg3rnW8R1mT0Ll3FG8
4ixROIGSqwKBgQCbtPiLFmMpmPS7XfXv00IEfTnjRq7M9Tt8Xntukme2tP4R1wZk
LKfUGCVw9TCKavS5anAklYPKfigOlG5k47h6MSauiotwPfXA9IVQl7kY2BbNn6N5
ZN1UWCPx9AvOqIOWE+VD9lM1fzi35MgrYLhNBETfCueP55FzS9rCP0DBVQKBgGI6
oOnMzSRbsFOGY1QqRUDREB7dKP4IasCQ8hT3+yn6h5xoW67k6PP1/EZ6zV/kaGAu
gCPJ5NZbfFop8uhaDjVMZrp/o+QoHLTXJ3ulSyqAqc/UVBiNlhI+tsFEf0qRTZC8
AKNdBGF4ve28vOqK0dHwHUO/AKO1ySzBFm8jR5QTAoGAITBswWXgtWqXl/y8o1kQ
23jXpD0XBIBzpyXzW8yHge99058W3JmqQ9NMy7xdaqwV9cnArS6dkzyrZ1ZRnCs/
OgXikoHfPBBK89vqbqTLlqYPq2z7QmfWpGs6ufq/FgSqxEk0gvIXjZ6N3PkBR0Ia
MQB0WkAHcHJ+9np4dlvPxNU=
-----END PRIVATE KEY-----", true);
        }

        [Fact]
        public void ExportXmlPrivateKey_ShouldBeOk()
        {
            var rsa = RSA.Create();
            rsa.ImportPrivateKey(RSAKeyType.Xml, @"<RSAKeyValue>
  <Modulus>tuE1XbeCD5bS0tLnlH4mVb6odtfztJQRNDbOhTY9rWmyc6H+8+2HHF4N8vZC8tgQnUj6KYvllQAxeUDsjmLY4XbYPZP1px8xevMP/BTM+ogc5HIfuSJrawJW87fJvjDzquR4efRkNXxeNscRp1E4ZAyrq6aiJOxhQ6UgGOsRLVlbCZMNKJQTsPWOe9aO1KfvujmphdBz754YrAWbvyYplYyg1ritTmEcFH5LNYKfrdNQvOZfDFWz9G8fwV/2efNZI8zOGX4E7uRzByL+PRDud5A60FXjjbOxYOKxXE49ESsBsdWqmz2+TtmDtVbEqieof0iDkMqD9y/EAugKTR9GMQ==</Modulus>
  <Exponent>AQAB</Exponent>
  <P>xlo0Vx6rGZQdlrtGheFNKk/VdJWH2hbLgggDhOHwYEFYIOX9t2vIAFApDeXD/7zHBYanenLfCCoNtYOEgyXT2Z24YFsh1X70H00+2bOmw2JQDPJL6OkEDJakiRV/oxEDCZilQVZvmAEPEGeLrZPErK0Rbcfp9mgOpu1EQH9RZSs=</P>
  <Q>7AfPVoPwcsG7+/4v2+ZXBIiW6bb0auqksYkbUaN3BRsoGGypD8HAj3HKG/BzAOnRAnE+Hhw1ND8sO7M7ghCcSQsfu40wvjS9LZbabt4PmQE29FQt2OrODEysQy+lPOeySju+pJtq5hbQOWyR7bTuBIGiEs0UgsGfSM1P2GIkTBM=</Q>
  <DP>oJxsI1su+qBHsUTlnwTHYgqQ8j0eawboNNteVhxJcveWb9Urs3kv0qkWBS3Wnl7y3NOjC3C2jjrXLPJYu4VG3MBsioFgjSqmbC41RTzGPRF/dmw/8VG1OKhGhMYGuzjMN9oFfjmKVRAObZ8aqCuuJpBhO36UQTUTIDGhgYRWmU8=</DP>
  <DQ>RGnvGzCbHWgySNRgouidCF9e/tdc+TCSFDOdi4hKE1zPvmSgjESov+tHndmQPA+J2Z9hVfDvKvm0pIlLEmQmKLXkuMQwALHgs7oqDkCnXL4RY7iSoXFN0BrZQ5An4QN3ljTDCYtS7OZn7H0fvzrWUtAQXkq7Szs8JCn+nsWzp6k=</DQ>
  <InverseQ>Nk2C4v8YQvgP0TO3jWNlVFP4FEKeyvbcUMBPwoy0fTdrXqqiQG0KtCHXSOeSssFcns+v4vOH9nLy0aSMEtBP3mcLxK/P9tPU3lsSDOvAEhDplduPbXIUxqKci9ozVuske28Zbk8mSDmbeL5oftx27u65p7d9icu3PYcTubWscWc=</InverseQ>
  <D>Uguzf3oGtau6pa7NCoeV9z30Im07/rW3Ci/Uc1skTJpw3wO8d/8GcKmZpHjrDDv3KDlHUkBbHX/askV4W2DpYC2LUgUBXprV/gzyDOvgEj3iiHLS3KIegwGntOutbNBVYUPi8QO9uWk0c2rX9rKvk+NDWV0GvX33HPwF7Gf5atg66AGgn2AiibOCPXAchgw7CpKpvuyPqXeZo3oI3aFCMz3naw8EqZO9UILu0+v/SqVEPm3cnvEyCpgvay3adal2Va9WCk0tHZwS7gE7KccWZjrFP54s21HkseE0YDHEfGa/O+wAiOXoN0IHmY2ljP2GvvY7QnAGILCwZkqSsvR/yQ==</D>
</RSAKeyValue>");
        }

        [Fact]
        public void ExportXmlPrivateKey_ShouldBeExp()
        {
            var rsa = RSA.Create();
            Assert.Throws<Exception>(() => rsa.ImportPrivateKey(RSAKeyType.Xml,
                @"<RSAKeyValue>
  <Modulus>tuE1XbeCD5bS0tLnlH4mVb6odtfztJQRNDbOhTY9rWmyc6H+8+2HHF4N8vZC8tgQnUj6KYvllQAxeUDsjmLY4XbYPZP1px8xevMP/BTM+ogc5HIfuSJrawJW87fJvjDzquR4efRkNXxeNscRp1E4ZAyrq6aiJOxhQ6UgGOsRLVlbCZMNKJQTsPWOe9aO1KfvujmphdBz754YrAWbvyYplYyg1ritTmEcFH5LNYKfrdNQvOZfDFWz9G8fwV/2efNZI8zOGX4E7uRzByL+PRDud5A60FXjjbOxYOKxXE49ESsBsdWqmz2+TtmDtVbEqieof0iDkMqD9y/EAugKTR9GMQ==</Modulus>
  <P>xlo0Vx6rGZQdlrtGheFNKk/VdJWH2hbLgggDhOHwYEFYIOX9t2vIAFApDeXD/7zHBYanenLfCCoNtYOEgyXT2Z24YFsh1X70H00+2bOmw2JQDPJL6OkEDJakiRV/oxEDCZilQVZvmAEPEGeLrZPErK0Rbcfp9mgOpu1EQH9RZSs=</P>
  <Q>7AfPVoPwcsG7+/4v2+ZXBIiW6bb0auqksYkbUaN3BRsoGGypD8HAj3HKG/BzAOnRAnE+Hhw1ND8sO7M7ghCcSQsfu40wvjS9LZbabt4PmQE29FQt2OrODEysQy+lPOeySju+pJtq5hbQOWyR7bTuBIGiEs0UgsGfSM1P2GIkTBM=</Q>
  <DP>oJxsI1su+qBHsUTlnwTHYgqQ8j0eawboNNteVhxJcveWb9Urs3kv0qkWBS3Wnl7y3NOjC3C2jjrXLPJYu4VG3MBsioFgjSqmbC41RTzGPRF/dmw/8VG1OKhGhMYGuzjMN9oFfjmKVRAObZ8aqCuuJpBhO36UQTUTIDGhgYRWmU8=</DP>
  <DQ>RGnvGzCbHWgySNRgouidCF9e/tdc+TCSFDOdi4hKE1zPvmSgjESov+tHndmQPA+J2Z9hVfDvKvm0pIlLEmQmKLXkuMQwALHgs7oqDkCnXL4RY7iSoXFN0BrZQ5An4QN3ljTDCYtS7OZn7H0fvzrWUtAQXkq7Szs8JCn+nsWzp6k=</DQ>
  <InverseQ>Nk2C4v8YQvgP0TO3jWNlVFP4FEKeyvbcUMBPwoy0fTdrXqqiQG0KtCHXSOeSssFcns+v4vOH9nLy0aSMEtBP3mcLxK/P9tPU3lsSDOvAEhDplduPbXIUxqKci9ozVuske28Zbk8mSDmbeL5oftx27u65p7d9icu3PYcTubWscWc=</InverseQ>
  <D>Uguzf3oGtau6pa7NCoeV9z30Im07/rW3Ci/Uc1skTJpw3wO8d/8GcKmZpHjrDDv3KDlHUkBbHX/askV4W2DpYC2LUgUBXprV/gzyDOvgEj3iiHLS3KIegwGntOutbNBVYUPi8QO9uWk0c2rX9rKvk+NDWV0GvX33HPwF7Gf5atg66AGgn2AiibOCPXAchgw7CpKpvuyPqXeZo3oI3aFCMz3naw8EqZO9UILu0+v/SqVEPm3cnvEyCpgvay3adal2Va9WCk0tHZwS7gE7KccWZjrFP54s21HkseE0YDHEfGa/O+wAiOXoN0IHmY2ljP2GvvY7QnAGILCwZkqSsvR/yQ==</D>
</RSAKeyValue>"));
        }

    }
}